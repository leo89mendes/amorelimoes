(function ($) {
    'use strict';

    /* global ajaxurl, wpWidgets */

    /**
     * generated by Pikart\WpCore\Admin\Sidebars\CustomSidebarFacade php class
     */
    var customSidebarsOptions = window.hasOwnProperty('pikartCustomSidebarsOptions') ?
        window.pikartCustomSidebarsOptions : {
            messages: {
                confirmationMessage: '?'
            }
        };

    $(document).ready(function () {

        $('.custom-sidebar-delete-button').on('click', function (event) {
            if (!window.confirm(customSidebarsOptions.messages.confirmationMessage)) {
                return;
            }

            var sidebar = $(event.currentTarget).parents('.widgets-holder-wrap:eq(0)');

            $.ajax({
                method: 'POST',
                url: ajaxurl,
                data: {
                    action: 'pikart_custom_sidebar_delete_ajax',
                    custom_sidebar_id: $(this).val(),
                    pikart_custom_sidebar_nonce: $('#pikart_custom_sidebar_nonce').val()
                },
                success: function (response) {
                    if (response.success) {
                        //delete all widgets inside
                        $('.widget-control-remove', sidebar).trigger('click');
                        sidebar.remove();
                        wpWidgets.saveOrder();
                    }
                }
            });
        });
    });
})(jQuery);